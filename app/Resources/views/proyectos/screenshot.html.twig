<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script type="text/javascript" src="{{ asset('Resources/screenshot/jquery-1.11.3-jquery.min.js')}}"></script>
<script type="text/javascript" src="{{ asset('Resources/screenshot/html2canvas.js')}}"></script>
<script type="text/javascript" src='http://maps.google.com/maps/api/js?key=AIzaSyATr6uedTPB7AVBBRNjCPmCJ_OEymxQUQI&sensor=false&libraries=places'></script>
 <script src="{{ asset('Resources/localizacion/src/locationpicker.jquery.js') }}"></script>
<style type="text/css">
*{margin:0;padding:0;}
#main-container
{
	margin:50px auto;
	padding:15px;
	border:solid #cdcdcd 1px;
	width:500px;
	background:#f9f9f9;
}
table,td
{
	font-family:Verdana, Geneva, sans-serif;
	width:100%;
	border-collapse:collapse;
	padding:10px;
}
input
{
	width:100%;
	height:35px;
	text-align:left;
	padding-left:10px;
	border:solid #cddcdc 2px;
	font-family:Verdana, Geneva, sans-serif;
	border-radius:3px;
}
button
{
	text-align:center;
	width:48%;
	height:35px;
	border:0;
	font-family:Verdana, Geneva, sans-serif;
	border-radius:3px;
	background:#364956;
	color:#fff;
	font-weight:bolder;
	font-size:18px;
	border-radius:10px;
}
hr
{
	border:solid #cecece 1px;
}
#header
{
	width:100%;
	height:50px;
	background:#364956;
	text-align:center;
}
#header h1
{
	font-family:Verdana, Geneva, sans-serif;
	font-size:18px;
	color:#f9f9f9;
	padding-top:10px;
}
a{
	font-family:Verdana, Geneva, sans-serif;
	color:#364956;
	text-decoration:none;
}
</style>
</head>

<body>
<br /><br />

      <div class="form-column col-md-12">
   
                                                  <meta name="viewport" content="width=device-width, initial-scale=1.0">
                                                  <div id="content">
                                                  <div class="form-horizontal" style="width: 100%">
                                                      
                                                      <div class="form-group" style="display: block;">
                                                          <label class="col-sm-2 control-label">Buscar:</label>

                                                          <div class="col-sm-8">
                                                              <input type="text" class="form-control" id="us3-address" />
                                                          </div>
                                                          <div class="col-sm-2">
                                                              <input type="button" class="btn btn-success" id="guardarCambios" value="Guardar Cambios">
                                                          </div>
                                                      </div>
                                                      <div class="form-group" style="display: none;">
                                                          <label class="col-sm-2 control-label">Radio:</label>

                                                          <div class="col-sm-5">
                                                              <input type="text" class="form-control" id="us3-radius"  />
                                                          </div>
                                                      </div>
                                                      <div id="us3" style="width: 100%; height: 500px;"></div>

                                                      <div class="clearfix">&nbsp;</div>
                                                      <div class="m-t-small" style="display: none;">
                                                          <label class="p-r-small col-sm-1 control-label">Lat.:</label>

                                                          <div class="col-sm-3">
                                                              <input type="text" class="form-control" style="width: 110px" id="us3-lat" />
                                                          </div>
                                                          <label class="p-r-small col-sm-2 control-label">Long.:</label>

                                                          <div class="col-sm-3">
                                                              <input type="text" class="form-control" style="width: 110px" id="us3-lon" />
                                                          </div>
                                                      </div>
                                                      <div class="clearfix"></div>
                                                      <script>
                                              
                                                           var x =13.70036411285400400000;
                                                           var y =-89.22023010253906000000;


                                                     $(document).ready(function() {
                                                         $("#guardarCambios").hide();
 
                                                          $('#us3').locationpicker({
                             

                                                              location: {
                               
                                                                  latitude: x,
                                                                  longitude: y	
                                                              },
                                                              radius: 0,
                                                              inputBinding: {
                                                                  latitudeInput: $('#us3-lat'),
                                                                  longitudeInput: $('#us3-lon'),
                                                                  radiusInput: $('#us3-radius'),
                                                                  locationNameInput: $('#us3-address')
                                                              },
                                                              enableAutocomplete: true,
                                                              onchanged: function (currentLocation, radius, isMarkerDropped) {
                                                                  // Uncomment line below to show alert on each Location Changed event
                                                                 //alert("Location changed. New location (" + currentLocation.latitude + ", " + currentLocation.longitude  +")");
                                                                  var  latitud=currentLocation.latitude;
                                                                  var longitud = currentLocation.longitude;
                                                                  $("#longitud").val(longitud);
                                                                  $("#latitude").val(latitud);
                                                                  
                                 
                                                                  var mapContext = $(this).locationpicker('map');
                                                                  mapContext.map.setZoom(17);
                                                                  
                                                                 {#Habilitar cuendo ya este en la edicion del proyecto#}
                                                                 {# $.ajax({
                                                                         type: 'POST',
                                                                         async: false,
                                                                         dataType: 'json',
                                                                         data: {longitudes:longitud , latitudes:latitud},
                                                                         url: Routing.generate('ingresarDireccionGoogleProyecto'),
                                                                         success: function (data)
                                                                         {
                                                                               $("#guardarCambios").show();
                                                                                 console.log(true);
                                                                         },
                                                                         error: function (xhr, status)
                                                                         {
                                         
                                                                                 Lobibox.notify("error", {
                                                                                                          size: 'mini',
                                                                                                          msg: 'Disculpe, existi√≥ un problema'
                                                                                                      });
                                                                         }
                                                                 });#}

                                                              }
                           

                                                          });
                         
                                                      });
                                                      </script>
                                                  </div>
                                                 </div>                           
                                    

	<div id="form" class="result">
		<button type="button" onclick="captureCurrentDiv()">Current Div</button>
		
	</div>
</div>
<div id="imgen">
    
    <img src="" id="prueba"></img>
    
    
    
</div>
</body>
</html>
<script type="text/javascript">
    
    var transform=$(".gm-style>div:first>div").css("transform")
    var comp=transform.split(",") //split up the transform matrix
    var mapleft=parseFloat(comp[4]) //get left value
    var maptop=parseFloat(comp[5])  //get top value
    $(".gm-style>div:first>div").css({ //get the map container. not sure if stable
      "transform":"none",
      "left":mapleft,
      "top":maptop,
    })
	function captureCurrentDiv()
	{
                     html2canvas($('#us3'),
                    {
                      useCORS: true,
                      onrendered: function(canvas)
                      {
                        var dataUrl= canvas.toDataURL('image/png');
                      //  location.href=dataUrl //for testing I never get window.open to work
                       $("#prueba").attr('src', dataUrl);
                        $(".gm-style>div:first>div").css({
                          left:0,
                          top:0,
                          "transform":transform
                        })
                      }
                 });
		
	}
	
	function captureFullPage()
	{
		html2canvas(document.body, {  
			onrendered: function(canvas)  
			{
				var img = canvas.toDataURL()
				
                                                                $("#prueba").attr('src', img);
                                
			}
		});
	}
</script>